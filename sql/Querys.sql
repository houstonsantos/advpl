-- A VERIFICAR
SELECT 
	CT1_CONTA,
	CT1_DESC01 
FROM 
	CT1020 CT1
	LEFT JOIN CVD020 CVD ON CT1.CT1_CONTA = CVD.CVD_CONTA AND CVD.D_E_L_E_T_ <> '*' AND CVD.CVD_CODPLA = '002'
WHERE 
	CT1.D_E_L_E_T_ <> '*' AND 
	CT1.CT1_CLASSE = '2'  AND 
	CVD.D_E_L_E_T_ IS NULL
ORDER BY CT1_CONTA;


-- CONTROLE 
SELECT CT2_SEQUEN, R_E_C_N_O_, * FROM CT2010 WHERE R_E_C_N_O_ = '622695' AND D_E_L_E_T_ = '';
SELECT CV3_SEQUEN, R_E_C_N_O_, CV3_RECORI, CV3_RECDES, * FROM CV3010 WHERE  CV3_SEQUEN = '0000341912' AND D_E_L_E_T_ = '';
SELECT * FROM SRZ010 WHERE R_E_C_N_O_ IN(1002542, 1002914, 1003099);


-- RELATÓRIO DE PRODUTOS VENDIDOS (ANÁLISE DE CUSTO)
SELECT D1_COD, D1_QUANT, D1_VUNIT, D1_TOTAL FROM SD1020 WHERE D1_COD = '012477' AND D1_EMISSAO BETWEEN '20200101' AND '20200331' 
SELECT B1_MCUSTD, * FROM SB1020 WHERE B1_COD = '001769'
SELECT D1_CUSTO, * FROM SD1030 WHERE D1_COD = '001769' AND D_E_L_E_T_ <> '*'
SELECT D2_CUSTO1, * FROM SD2030 WHERE D2_COD = '001769' 
SELECT D3_CUSTO1, * FROM SD3030 WHERE D3_COD = '001769' 
SELECT B2_CM1, * FROM SB2030 WHERE B2_COD = '001769' AND D_E_L_E_T_ <> '*'
SELECT D2_CUSTO1, D2_QUANT, D2_PRCVEN, D2_TOTAL, D2_VALICM, D2_TES, D2_CF, D2_PICM, D2_ALQIMP5, D2_ALQIMP6, D2_ALIQSOL, D2_ALQPIS, D2_ALQCOF, D2_ALQCSL, D2_TOTIMP, D2_TOTFED, D2_TOTEST
FROM SD2020 WHERE D2_COD = '001769' AND D2_EMISSAO BETWEEN '20191101' AND '20191130' AND D_E_L_E_T_ <> '*'


-- VERIFICAR CNPJ DUPLICADOS
SELECT A2_CGC, COUNT(*) FROM SA2020 WHERE D_E_L_E_T_ <> '*'
GROUP BY A2_CGC
HAVING COUNT(*) > 1 
GO


-- EXEMPLOS
SELECT F2_CLIENTE FROM (SELECT DISTINCT SF2.F2_CLIENTE, SA1.A1_NOME FROM SF2020 AS SF2 
LEFT JOIN SA1020 AS SA1
ON SF2.F2_CLIENTE = SA1.A1_COD 
WHERE SF2.F2_EMISSAO >= 20170101 AND SA1.D_E_L_E_T_ <> '*') as t

SELECT DISTINCT(SD2.D2_COD), SB1.B1_DESC FROM SD2010 AS SD2 
LEFT JOIN SB1010 AS SB1
ON SD2.D2_COD = SB1.B1_COD 
WHERE SD2.D2_EMISSAO BETWEEN '20180101' AND GETDATE() AND SD2.D_E_L_E_T_ <> '*' AND SB1.B1_DESC IS NULL
GO

SELECT T.CODIGO, T.NOME, T.UNIDADE, T.NCM, T.CEST, P1.B1_COD, P1.B1_CODTEKN, P2.B1_COD, P2.B1_CODTEKN, P4.B1_COD, P4.B1_CODTEKN
FROM ProdutoTeknisa AS T
LEFT JOIN SB1010 AS P1 ON T.CODIGO = P1.B1_CODTEKN
LEFT JOIN SB1020 AS P2 ON T.CODIGO = P2.B1_CODTEKN
LEFT JOIN SB1040 AS P4 ON T.CODIGO = P4.B1_CODTEKN
WHERE P1.B1_COD IS NULL OR P2.B1_COD IS NULL OR P4.B1_COD IS NULL

SELECT D1_COD, SUM(D1_QUANT), SUM(D1_VUNIT), SUM(D1_TOTAL) 
FROM SD1020 WHERE D1_EMISSAO BETWEEN '20200201' AND '20200201' 
GROUP BY D1_COD

SELECT DISTINCT FUN.RA_FILIAL, FUN.RA_NOME, CAR.RJ_DESC, RES.RG_DTAVISO, RES.RG_DATADEM 
FROM SRA020 FUN
INNER JOIN SRG020 RES ON RES.RG_MAT = FUN.RA_MAT
INNER JOIN SRJ020 CAR ON CAR.RJ_FUNCAO = FUN.RA_CODFUNC
WHERE RES.RG_DTAVISO >= '20200331'
AND   RES.D_E_L_E_T_ <> '*'
ORDER BY 2

SELECT ED_CODIGO, ED_DESCRIC, ED_USO, ED_TIPO, 
    CASE ED_USO
        WHEN '1' THEN 'Receber'
        WHEN '2' THEN 'Pagar'
        WHEN '3' THEN 'M. Bancario'
        WHEN '0' THEN 'Nao informado'
        WHEN ''  THEN 'Nao informado'
    END AS 'Tipo de Uso'
    FROM SED020 
WHERE 
    D_E_L_E_T_ <> '*' ORDER BY 1

SELECT 
    E2_FILIAL AS FILIAL, 
    E2_NUM AS 'NUM. TITULO',
    E2_PARCELA AS PARCELA, 
    E2_VENCREA AS VENCIMENTO, 
    E2_BAIXA AS PAGAMENTO, 
    E2_VALLIQ AS VALOR,
    A2_CGC AS CNPJ,
    A2_NOME 
FROM SE2020 SE2
INNER JOIN SA2020 SA2 
ON SE2.E2_FORNECE = SA2.A2_COD
    WHERE SE2.E2_BAIXA BETWEEN '20200101' AND '20201031' AND
    SE2.D_E_L_E_T_ <> '*' AND
    SA2.D_E_L_E_T_ <> '*'
ORDER BY 4

SELECT 
    L4_FILIAL AS LOJA, 
    L4_DATATEF AS 'DATA', 
    L4_NSUTEF AS NSU, 
    L4_AUTORIZ AS AUTORIZACAO, 
    L4_ADMINIS AS ADMINISTRADORA,
    L4_BANDEIR AS 'COD. BANDEIRA',
    L4_PARCTEF AS PARCELAS,
    L4_VALOR AS VALOR
FROM SL4020
WHERE 
    L4_DATATEF BETWEEN 20201101 AND 20201130 AND
    D_E_L_E_T_ <> '*'

SELECT 
    B1_COD, 
    B1_DESC 
FROM SB1060
WHERE B1_COD NOT IN(
SELECT D1_COD FROM SD1060 WHERE D1_DTDIGIT BETWEEN 20200201 AND 20201130 AND D_E_L_E_T_ <> '*' 
UNION
SELECT D2_COD FROM SD2060 WHERE D2_EMISSAO BETWEEN 20200201 AND 20201130 AND D_E_L_E_T_ <> '*')

SELECT 
    DISTINCT(B1_COD) AS CODIGO, 
    B1_DESC AS DESCRICAO,
    B1_UM AS UNIDADE,
    B1_GRUPO AS 'COD. GRUPO',
    BM_DESC AS 'DESC. GRUPO',
    B1_POSIPI AS NCN
    --SUM(D1_QUANT) AS 'TOTAL ENTRADA',
    --SUM(D2_QUANT) AS 'TOTAL SAIDA' 
FROM SB1060 AS SB1
INNER JOIN SBM060 AS SBM ON SB1.B1_GRUPO = SBM.BM_GRUPO
WHERE B1_COD IN(
SELECT D1_COD FROM SD1060 WHERE D1_DTDIGIT BETWEEN 20200201 AND 20201130 AND D_E_L_E_T_ <> '*' 
UNION
SELECT D2_COD FROM SD2060 WHERE D2_EMISSAO BETWEEN 20200201 AND 20201130 AND D_E_L_E_T_ <> '*')
